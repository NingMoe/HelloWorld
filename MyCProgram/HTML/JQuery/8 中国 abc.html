<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="jquery-1.11.3.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {

        //var surl =  "http://172.16.134.248/CMApi/api/basic/account/login",
        var surl =  "http://172.16.134.248:9023/CMApi/api/basic/account/login";

        $("#clickme").click(function(event) {
            //url: "http://172.16.134.248:9023/CMApi/api/basic/account/login",
            /*
            $.ajax({
                type: "POST",
                async: false,
                url: "http://172.16.134.248:9023/CMApi/api/basic/account/login",
                data: "{ \"LOGINNAME\": \"admin\", \"LOGINPWD\": \"21232f297a57a5a743894a0e4a801fc3\", \"LOGINSUBSYSTEM\": \"sys\", \"LOGINIP\": \"127.0.0.1\" }",
                dataType: "json",
                error: function(xhr, type, exception) {
                    console.log(xhr.responseText, "Failed");
                },
                beforeSend: function(xhr) {
                    xhr.setRequestHeader("sobeyhive-http-system", "MOS");
                    xhr.setRequestHeader("sobeyhive-http-site", "S1");
                    xhr.setRequestHeader("sobeyhive-http-tool", "MOSGATEWAY");
                },
                success: function(data) {
                    if (data.code == "0") {
                        userToken = data.ext.usertoken;
                    }
                }
            });
            */
             $.ajax({
                type: "POST",
                async: false,
                url: surl,
                data: "{ \"LOGINNAME\": \"admin\", \"LOGINPWD\": \"21232f297a57a5a743894a0e4a801fc3\", \"LOGINSUBSYSTEM\": \"sys\", \"LOGINIP\": \"127.0.0.1\" }",
                dataType: "json",
                error: function(xhr, type, exception) {
                    console.log(xhr.responseText, "Failed");
                },
                beforeSend: function(xhr) {
                    xhr.setRequestHeader("sobeyhive-http-system", "MOS");
                    xhr.setRequestHeader("sobeyhive-http-site", "S1");
                    xhr.setRequestHeader("sobeyhive-http-tool", "MOSGATEWAY");
                },
                success: function(data) {
                    if (data.code == "0") {
                        userToken = data.ext.usertoken;
                    }
                }
            });
        });

        $("#clickme1").click(function(event) {
            /* Act on the event */
            log("clickme1");

            postJson(surl,
            false,
            "{ \"LOGINNAME\": \"admin\", \"LOGINPWD\": \"21232f297a57a5a743894a0e4a801fc3\", \"LOGINSUBSYSTEM\": \"sys\", \"LOGINIP\": \"127.0.0.1\" }",
            function(b, obj) {
                if (b) {
                    if (obj.code == "0") {
                        userToken = data.ext.usertoken;
                    }
                }
            });

        });


        function log(msg) {
            $("#info").append(msg + "</br>");
            postJson()
        }


        function createCORSRequest(method, url) {
            var xhr = new XMLHttpRequest();
            if ("withCredentials" in xhr) {
                xhr.open(method, url, true);
            } else if (typeof XDomainRequest !== "undefined") {
                xhr = new XDomainRequest();
                xhr.open(method, url);
            } else {
                xhr = null;
            }
            return xhr;
        }

        function getJson(url, par, callback) {


            if (par) {
                var q = '';
                if (url.indexOf('?') >= 0) {
                    q = '&';
                } else {
                    q = '?';
                }

                for (var k in par) {
                    if (q.length > 1) {
                        q += '&';
                    }
                    q = q + k + "=" + encodeURIComponent(par[k]);
                }

                url = url + q;
            }


            var xhr = createCORSRequest("GET", url);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("sobeyhive-http-system", "MOS");
            xhr.setRequestHeader("sobeyhive-http-site", "S1");
            xhr.setRequestHeader("sobeyhive-http-tool", "MOSGATEWAY");
            xhr.onload = function() {
                var json = xhr.responseText;
                if (callback) {
                    callback(true, JSON.parse(json));
                }
            };

            xhr.onerror = function() {
                if (callback) {
                    callback(false, "");
                }
            };

            xhr.send();
        };

        function postJson(url, par, data, callback) {


            if (par) {
                var q = '';
                if (url.indexOf('?') >= 0) {
                    q = '&';
                } else {
                    q = '?';
                }

                for (var k in par) {
                    if (q.length > 1) {
                        q += '&';
                    }
                    q = q + k + "=" + encodeURIComponent(par[k]);
                }

                url = url + q;
            }


            var xhr = createCORSRequest("POST", url);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("sobeyhive-http-system", "MOS");
            xhr.setRequestHeader("sobeyhive-http-site", "S1");
            xhr.setRequestHeader("sobeyhive-http-tool", "DEFAULT");

            xhr.onload = function() {
                var json = xhr.responseText;
                if (callback) {
                    callback(true, JSON.parse(json));
                }
            };

            xhr.onerror = function() {
                if (callback) {
                    callback(false, "");
                }
            };
            //var strData = JSON.stringify(data);
            xhr.send(data);
        };



       


    });
    </script>
</head>

<body>
    <a href="1.html">this is a link</a>
    <div id="info" />
    <br />
    <input type="submit" id="clickme" width="200px"  value="jquery" />
    <br />
        <input type="submit" id="clickme1" width="200px" value="javascript" />
</body>

</html>
